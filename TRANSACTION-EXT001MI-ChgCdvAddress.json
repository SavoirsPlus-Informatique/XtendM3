{"programModules":{"EXT001MI":{"program":"EXT001MI","triggers":{},"transactions":{"ChgCdvAddress":{"sourceUuid":"4d64b8da-9065-4eb0-a933-a69cce9a1bba","name":"ChgCdvAddress","program":"EXT001MI","description":"Modification de l'adresse d'une commande de vente","active":true,"multi":false,"modified":1706610251289,"modifiedBy":"FRALEP","outputFields":[],"inputFields":[{"name":"ORNO","description":"Customer order number","length":10,"mandatory":true,"type":"A"},{"name":"ADRT","description":"Address type","length":2,"mandatory":true,"type":"N"},{"name":"ADID","description":"Address number","length":6,"mandatory":false,"type":"A"},{"name":"CUNM","description":"Name","length":36,"mandatory":false,"type":"A"},{"name":"CUA1","description":"Address line 1","length":36,"mandatory":false,"type":"A"},{"name":"CUA2","description":"Address line 2","length":36,"mandatory":false,"type":"A"},{"name":"CUA3","description":"Address line 3","length":36,"mandatory":false,"type":"A"},{"name":"PONO","description":"Postal code","length":10,"mandatory":false,"type":"A"},{"name":"TOWN","description":"City","length":20,"mandatory":false,"type":"A"},{"name":"ECAR","description":"State","length":2,"mandatory":false,"type":"A"},{"name":"CSCD","description":"Country","length":3,"mandatory":false,"type":"A"},{"name":"PHNO","description":"Telephone number 1","length":16,"mandatory":false,"type":"A"},{"name":"TFNO","description":"Facsimile transmission number","length":16,"mandatory":false,"type":"A"},{"name":"YREF","description":"Your reference 1","length":30,"mandatory":false,"type":"A"},{"name":"VRNO","description":"VAT registration number","length":16,"mandatory":false,"type":"A"},{"name":"SPLE","description":"Standard point location code","length":10,"mandatory":false,"type":"A"},{"name":"HAFE","description":"Harbor or airport","length":6,"mandatory":false,"type":"A"},{"name":"RASN","description":"Rail station","length":10,"mandatory":false,"type":"A"},{"name":"EDES","description":"Place","length":10,"mandatory":false,"type":"A"},{"name":"DLSP","description":"Delivery specification","length":12,"mandatory":false,"type":"A"},{"name":"DSTX","description":"Description","length":36,"mandatory":false,"type":"A"},{"name":"MODL","description":"Delivery method","length":3,"mandatory":false,"type":"A"},{"name":"TEDL","description":"Delivery terms","length":3,"mandatory":false,"type":"A"},{"name":"TEL2","description":"Terms text","length":36,"mandatory":false,"type":"A"}],"utilities":["DateUtil","NumberUtil"]}},"batches":{},"advancedPrograms":{}}},"utilities":{},"sources":{"4d64b8da-9065-4eb0-a933-a69cce9a1bba":{"uuid":"4d64b8da-9065-4eb0-a933-a69cce9a1bba","updated":1707984562317,"updatedBy":"FRALEP","created":1706541317584,"createdBy":"FRALEP","apiVersion":"0.9","beVersion":"16.0.0.20231212194056.5","language":"GROOVY","codeHash":"0AAF12C95B76E1943E6BA6116BEF2D1826F7B60092BBC89C2C5E24BA3BC6E800","code":"LyoqDQogKiBSRUFETUUNCiAqIENyw6lhdGlvbiBkJ3VuZSBBUEkgcG91ciBtZXR0cmUgw6Agam91ciBsJ2FkcmVzc2UgZCd1bmUgY29tbWFuZGUgZGUgdmVudGUuIE9uIGJsb3F1ZXJhIGxhIG1vZGlmaWNhdGlvbiBzaSBsZSBzdGF0dXQgZXN0ID49IDc3IChmYWN0dXLDqSkuDQogKg0KICogTmFtZTogQ2hnQ2R2QWRkcmVzcw0KICogRGVzY3JpcHRpb246IA0KICogRGF0ZSAgICAgICBDaGFuZ2VkIEJ5ICAgICAgICAgICAgICAgICAgICAgRGVzY3JpcHRpb24NCiAqIDIwMjQwMTI5ICAgRnJhbsOnb2lzIExlcHLDqXZvc3QgICAgICAgICAgICAgQ3LDqWF0aW9uIHZlcmJlIENoZ0NkdkFkZHJlc3MNCiAqLw0KcHVibGljIGNsYXNzIENoZ0NkdkFkZHJlc3MgZXh0ZW5kcyBFeHRlbmRNM1RyYW5zYWN0aW9uIHsNCiAgcHJpdmF0ZSBmaW5hbCBNSUFQSSBtaQ0KICBwcml2YXRlIGZpbmFsIERhdGFiYXNlQVBJIGRhdGFiYXNlDQogIHByaXZhdGUgZmluYWwgUHJvZ3JhbUFQSSBwcm9ncmFtDQogIHByaXZhdGUgZmluYWwgVXRpbGl0eUFQSSB1dGlsaXR5DQogIA0KICBwdWJsaWMgQ2hnQ2R2QWRkcmVzcyhNSUFQSSBtaSwgRGF0YWJhc2VBUEkgZGF0YWJhc2UgLCBQcm9ncmFtQVBJIHByb2dyYW0sIE1JQ2FsbGVyQVBJIG1pQ2FsbGVyLCBVdGlsaXR5QVBJIHV0aWxpdHkpIHsNCiAgICB0aGlzLm1pID0gbWkNCiAgICB0aGlzLmRhdGFiYXNlID0gZGF0YWJhc2UNCiAgICB0aGlzLnByb2dyYW0gPSBwcm9ncmFtDQogICAgdGhpcy51dGlsaXR5ID0gdXRpbGl0eQ0KICB9DQogIA0KICBpbnQgY29ubyA9IDANCiAgU3RyaW5nIGNoaWQgPSAiIg0KICBTdHJpbmcgY3VubyA9ICIiDQogIE1hcDxTdHJpbmcsIFN0cmluZz4gbWFwID0gbmV3IEhhc2hNYXA8U3RyaW5nLCBTdHJpbmc+KCkNCiAgU3RyaW5nIG9ybm8gPSAiIg0KICBTdHJpbmcgYWRpZE9PSEVBRCA9ICIiDQogIA0KICBwdWJsaWMgdm9pZCBtYWluKCkgew0KICAgIGNvbm8gPSAoSW50ZWdlcikgcHJvZ3JhbS5nZXRMREFaRCgpLkNPTk8NCiAgICBjaGlkID0gcHJvZ3JhbS5nZXRVc2VyKCkNCiAgICANCiAgICBvcm5vID0gKG1pLmluRGF0YS5nZXQoIk9STk8iKSA9PSBudWxsKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiT1JOTyIpLnRyaW0oKQ0KICAgIGlmIChvcm5vLmlzRW1wdHkoKSkgew0KICAgICAgbWkuZXJyb3IoIkxlIG51bcOpcm8gZGUgY29tbWFuZGUgZXN0IG9ibGlnYXRvaXJlLiIpDQogICAgICByZXR1cm4NCiAgICB9IGVsc2Ugew0KICAgICAgT3B0aW9uYWw8REJDb250YWluZXI+IGNvbnRhaW5lciA9IGNoZWNrT3JkZXJFeGlzdChvcm5vKQ0KICAgICAgaWYgKGNvbnRhaW5lci5pc1ByZXNlbnQoKSkgew0KICAgICAgICBEQkNvbnRhaW5lciByZWNvcmQgPSBjb250YWluZXIuZ2V0KCkNCiAgICAgICAgaW50IG9yc2wgPSBJbnRlZ2VyLnBhcnNlSW50KFN0cmluZy52YWx1ZU9mKHJlY29yZC5nZXQoIk9BT1JTTCIpKSkNCiAgICAgICAgaW50IG9yc3QgPSBJbnRlZ2VyLnBhcnNlSW50KFN0cmluZy52YWx1ZU9mKHJlY29yZC5nZXQoIk9BT1JTVCIpKSkNCiAgICAgICAgaWYgKG9yc2wgPj0gNzcgfHwgb3JzdCA+PSA3Nykgew0KICAgICAgICAgIG1pLmVycm9yKCJMYSBjb21tYW5kZSBlc3QgZmFjdHVyw6llLCBsJ2FkcmVzc2UgbmUgcGV1dCDDqnRyZSBtb2RpZmnDqWUuIikNCiAgICAgICAgICByZXR1cm4NCiAgICAgICAgfQ0KICAgICAgICBpbnQgaG9jZCA9IEludGVnZXIucGFyc2VJbnQoU3RyaW5nLnZhbHVlT2YocmVjb3JkLmdldCgiT0FIT0NEIikpKQ0KICAgICAgICBpZiAoaG9jZCA+IDApIHsNCiAgICAgICAgICBTdHJpbmcgbWVzc2FnZSA9ICJMYSBjb21tYW5kZSBlc3QgdmVycm91aWxsw6llIHBhciBsJ3V0aWxpc2F0ZXVyICIgKyByZWNvcmQuZ2V0KCJPQUNISUQiKSArICIsIGxhIG1vZGlmaWNhdGlvbiBlc3QgaW1wb3NzaWJsZS4iDQogICAgICAgICAgbWkuZXJyb3IobWVzc2FnZSkNCiAgICAgICAgICByZXR1cm4NCiAgICAgICAgfQ0KICAgICAgICBjdW5vID0gU3RyaW5nLnZhbHVlT2YocmVjb3JkLmdldCgiT0FDVU5PIikpDQogICAgICAgIGFkaWRPT0hFQUQgPSBTdHJpbmcudmFsdWVPZihyZWNvcmQuZ2V0KCJPQUFESUQiKSkNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIG1pLmVycm9yKCJMYSBjb21tYW5kZSBlc3QgaW5leGlzdGFudGUuIikNCiAgICAgICAgcmV0dXJuDQogICAgICB9DQogICAgfQ0KICAgIA0KICAgIFN0cmluZyBhZHJ0ID0gKG1pLmluRGF0YS5nZXQoIkFEUlQiKSA9PSBudWxsKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiQURSVCIpLnRyaW0oKQ0KICAgIGlmIChhZHJ0LmlzRW1wdHkoKSkgew0KICAgICAgbWkuZXJyb3IoIkxlIHR5cGUgZCdhZHJlc3NlIGVzdCBvYmxpZ2F0b2lyZS4iKQ0KICAgICAgcmV0dXJuDQogICAgfSBlbHNlIGlmICghdXRpbGl0eS5jYWxsKCJOdW1iZXJVdGlsIiwiaXNWYWxpZE51bWJlciIsIGFkcnQsICIuIikpIHsNCiAgICAgIG1pLmVycm9yKCJMZSB0eXBlIGRlIGNvbW1hbmRlIGVzdCBpbmNvcnJlY3QuIikNCiAgICAgIHJldHVybg0KICAgIH0NCiAgICAgIA0KICAgIFN0cmluZyBjc2NkID0gKG1pLmluRGF0YS5nZXQoIkNTQ0QiKSA9PSBudWxsKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiQ1NDRCIpLnRyaW0oKQ0KICAgIGlmICghY3NjZC5pc0VtcHR5KCkgJiYgIWNoZWNrQ3N5dGFiRXhpc3QoIkNTQ0QiLCBjc2NkLCAiIikpIHsNCiAgICAgIG1pLmVycm9yKCJMZSBwYXlzIG4nZXhpc3RlIHBhcyIpDQogICAgICByZXR1cm4NCiAgICB9DQogICAgDQogICAgU3RyaW5nIG1vZGwgPSAobWkuaW5EYXRhLmdldCgiTU9ETCIpID09IG51bGwpID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJNT0RMIikudHJpbSgpDQogICAgaWYgKCFtb2RsLmlzRW1wdHkoKSAmJiAhY2hlY2tDc3l0YWJFeGlzdCgiTU9ETCIsIG1vZGwsICJGUiIpKSB7DQogICAgICBpZiAoIWNoZWNrQ3N5dGFiRXhpc3QoIk1PREwiLCBtb2RsLCAiRlIiKSkgew0KICAgICAgICBtaS5lcnJvcigiTGUgbW9kZSBkZSBsaXZyYWlzb24gbidleGlzdGUgcGFzIikNCiAgICAgICAgcmV0dXJuDQogICAgICB9DQogICAgfQ0KICAgIA0KICAgIFN0cmluZyB0ZWRsID0gKG1pLmluRGF0YS5nZXQoIlRFREwiKSA9PSBudWxsKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiVEVETCIpLnRyaW0oKQ0KICAgIGlmICghdGVkbC5pc0VtcHR5KCkgJiYgIWNoZWNrQ3N5dGFiRXhpc3QoIlRFREwiLCB0ZWRsLCAiRlIiKSkgew0KICAgICAgaWYgKCFjaGVja0NzeXRhYkV4aXN0KCJURURMIiwgdGVkbCwgIiIpKSB7DQogICAgICAgIG1pLmVycm9yKCJMZXMgY29uZGl0aW9ucyBkZSBsaXZyYWlzb24gbidleGlzdGVudCBwYXMiKQ0KICAgICAgICByZXR1cm4NCiAgICAgIH0NCiAgICB9DQogICAgDQogICAgU3RyaW5nIGFkaWQgPSAobWkuaW5EYXRhLmdldCgiQURJRCIpID09IG51bGwpID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJBRElEIikudHJpbSgpDQogICAgaWYgKGFkaWQuaXNFbXB0eSgpICYmIGFkcnQuZXF1YWxzKCIxIikpIHsNCiAgICAgICAgbWkuZXJyb3IoIkxlIGNvZGUgYWRyZXNzZSBlc3Qgb2JsaWdhdG9pcmUgcG91ciBsJ2FkcmVzc2UgZGUgbGl2cmFpc29uIChBRFJUID0gMSkiKQ0KICAgICAgICByZXR1cm4NCiAgICB9DQogICAgDQogICAgYWxpbU1hcChjc2NkKQ0KICAgIHVwZGF0ZUFkZHJlc3Mob3JubywgYWRydCkNCiAgfQ0KICANCiAgLyoqDQogICogT24gZW5yZWdpc3RyZSBkYW5zIGxhIEhhc2hNYXAgbGVzIGRvbm7DqWVzIGVuIGVudHLDqWUgZGUgbCdBUEkuDQogICovDQogIHByaXZhdGUgYWxpbU1hcChTdHJpbmcgY3NjZCkgew0KICAgIFN0cmluZyBhZGlkID0gKG1pLmluRGF0YS5nZXQoIkFESUQiKSA9PSBudWxsKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiQURJRCIpLnRyaW0oKQ0KICAgIFN0cmluZyBjdW5tID0gKG1pLmluRGF0YS5nZXQoIkNVTk0iKSA9PSBudWxsKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiQ1VOTSIpLnRyaW0oKQ0KICAgIFN0cmluZyBjdWExID0gKG1pLmluRGF0YS5nZXQoIkNVQTEiKSA9PSBudWxsKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiQ1VBMSIpLnRyaW0oKQ0KICAgIFN0cmluZyBjdWEyID0gKG1pLmluRGF0YS5nZXQoIkNVQTIiKSA9PSBudWxsKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiQ1VBMiIpLnRyaW0oKQ0KICAgIFN0cmluZyBjdWEzID0gKG1pLmluRGF0YS5nZXQoIkNVQTMiKSA9PSBudWxsKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiQ1VBMyIpLnRyaW0oKQ0KICAgIFN0cmluZyBwb25vID0gKG1pLmluRGF0YS5nZXQoIlBPTk8iKSA9PSBudWxsKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiUE9OTyIpLnRyaW0oKQ0KICAgIFN0cmluZyB0b3duID0gKG1pLmluRGF0YS5nZXQoIlRPV04iKSA9PSBudWxsKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiVE9XTiIpLnRyaW0oKQ0KICAgIFN0cmluZyBjdWE0ID0gcG9ubyArICIgIiArIGN1YTENCiAgICBTdHJpbmcgZWNhciA9IChtaS5pbkRhdGEuZ2V0KCJFQ0FSIikgPT0gbnVsbCkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIkVDQVIiKS50cmltKCkNCiAgICBTdHJpbmcgcGhubyA9IChtaS5pbkRhdGEuZ2V0KCJQSE5PIikgPT0gbnVsbCkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlBITk8iKS50cmltKCkNCiAgICBTdHJpbmcgdGZubyA9IChtaS5pbkRhdGEuZ2V0KCJURk5PIikgPT0gbnVsbCkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlRGTk8iKS50cmltKCkNCiAgICBTdHJpbmcgeXJlZiA9IChtaS5pbkRhdGEuZ2V0KCJZUkVGIikgPT0gbnVsbCkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIllSRUYiKS50cmltKCkNCiAgICBTdHJpbmcgdnJubyA9IChtaS5pbkRhdGEuZ2V0KCJWUk5PIikgPT0gbnVsbCkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlZSTk8iKS50cmltKCkNCiAgICBTdHJpbmcgc3BsZSA9IChtaS5pbkRhdGEuZ2V0KCJTUExFIikgPT0gbnVsbCkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlNQTEUiKS50cmltKCkNCiAgICBTdHJpbmcgaGFmZSA9IChtaS5pbkRhdGEuZ2V0KCJIQUZFIikgPT0gbnVsbCkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIkhBRkUiKS50cmltKCkNCiAgICBTdHJpbmcgcmFzbiA9IChtaS5pbkRhdGEuZ2V0KCJSQVNOIikgPT0gbnVsbCkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlJBU04iKS50cmltKCkNCiAgICBTdHJpbmcgZWRlcyA9IChtaS5pbkRhdGEuZ2V0KCJFREVTIikgPT0gbnVsbCkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIkVERVMiKS50cmltKCkNCiAgICBTdHJpbmcgZGxzcCA9IChtaS5pbkRhdGEuZ2V0KCJETFNQIikgPT0gbnVsbCkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIkRMU1AiKS50cmltKCkNCiAgICBTdHJpbmcgZHN0eCA9IChtaS5pbkRhdGEuZ2V0KCJEU1RYIikgPT0gbnVsbCkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIkRTVFgiKS50cmltKCkNCiAgICBTdHJpbmcgbW9kbCA9IChtaS5pbkRhdGEuZ2V0KCJNT0RMIikgPT0gbnVsbCkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIk1PREwiKS50cmltKCkNCiAgICBTdHJpbmcgdGVkbCA9IChtaS5pbkRhdGEuZ2V0KCJURURMIikgPT0gbnVsbCkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlRFREwiKS50cmltKCkNCiAgICBTdHJpbmcgdGVsMiA9IChtaS5pbkRhdGEuZ2V0KCJURUwyIikgPT0gbnVsbCkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlRFTDIiKS50cmltKCkNCiAgICANCiAgICBtYXAucHV0KCJhZGlkIiwgYWRpZCkNCiAgICBtYXAucHV0KCJjdW5tIiwgY3VubSkNCiAgICBtYXAucHV0KCJjdWExIiwgY3VhMSkNCiAgICBtYXAucHV0KCJjdWEyIiwgY3VhMikNCiAgICBtYXAucHV0KCJjdWEzIiwgY3VhMykNCiAgICBtYXAucHV0KCJwb25vIiwgcG9ubykNCiAgICBtYXAucHV0KCJ0b3duIiwgdG93bikNCiAgICBtYXAucHV0KCJjdWE0IiwgY3VhNC50cmltKCkpDQogICAgbWFwLnB1dCgiZWNhciIsIGVjYXIpDQogICAgbWFwLnB1dCgicGhubyIsIHBobm8pDQogICAgbWFwLnB1dCgidGZubyIsIHRmbm8pDQogICAgbWFwLnB1dCgieXJlZiIsIHlyZWYpDQogICAgbWFwLnB1dCgidnJubyIsIHZybm8pDQogICAgbWFwLnB1dCgic3BsZSIsIHNwbGUpDQogICAgbWFwLnB1dCgiY3NjZCIsIGNzY2QpDQogICAgbWFwLnB1dCgiaGFmZSIsIGhhZmUpDQogICAgbWFwLnB1dCgicmFzbiIsIHJhc24pDQogICAgbWFwLnB1dCgiZWRlcyIsIGVkZXMpDQogICAgbWFwLnB1dCgiZGxzcCIsIGRsc3ApDQogICAgbWFwLnB1dCgiZHN0eCIsIGRzdHgpDQogICAgbWFwLnB1dCgibW9kbCIsIG1vZGwpDQogICAgbWFwLnB1dCgidGVkbCIsIHRlZGwpDQogICAgbWFwLnB1dCgidGVsMiIsIHRlbDIpDQogIH0NCiAgDQogIC8qKg0KICAqIE9uIHbDqXJpZmllIHF1ZSBsZSBudW3DqXJvIGRlIGNvbW1hbmRlIGV4aXN0ZSBldCBvbiByw6ljdXDDqHJlIGxlcyBjZXJ0YWluZXMgZG9ubsOpZXMgZGUgbGEgdGFibGUuDQogICovDQogIHByaXZhdGUgT3B0aW9uYWw8REJDb250YWluZXI+IGNoZWNrT3JkZXJFeGlzdChTdHJpbmcgb3Jubykgew0KICAgIERCQWN0aW9uIHF1ZXJ5ID0gZGF0YWJhc2UudGFibGUoIk9PSEVBRCIpDQogICAgICAuaW5kZXgoIjAwIikNCiAgICAgIC5zZWxlY3Rpb24oIk9BT1JTTCIsICJPQU9SU1QiLCAiT0FIT0NEIiwgIk9BQ1VOTyIpDQogICAgICAuYnVpbGQoKQ0KICAgIERCQ29udGFpbmVyIGNvbnRhaW5lciA9IHF1ZXJ5LmdldENvbnRhaW5lcigpDQogICAgY29udGFpbmVyLnNldCgiT0FDT05PIiwgY29ubykNCiAgICBjb250YWluZXIuc2V0KCJPQU9STk8iLCBvcm5vKQ0KICAgIA0KICAgIGJvb2xlYW4gZm91bmQgPSBxdWVyeS5yZWFkKGNvbnRhaW5lcikNCiAgICANCiAgICBpZiAoZm91bmQpIHsNCiAgICAgIHJldHVybiBPcHRpb25hbC5vZihjb250YWluZXIpDQogICAgfSBlbHNlIHsNCiAgICAgIHJldHVybiBPcHRpb25hbC5lbXB0eSgpDQogICAgfQ0KICB9DQogIA0KICAvKioNCiAgKiBPbiB2w6lyaWZpZSBxdWUgbGVzIGVucmVnaXN0cmVtZW50cyBkZSBDU1lUQUIgZXhpc3RlbnQuDQogICovDQogIHByaXZhdGUgYm9vbGVhbiBjaGVja0NzeXRhYkV4aXN0KFN0cmluZyBzdGNvLCBTdHJpbmcgc3RreSwgU3RyaW5nIGxuY2QpIHsNCiAgICBEQkFjdGlvbiBxdWVyeSA9IGRhdGFiYXNlLnRhYmxlKCJDU1lUQUIiKQ0KICAgICAgLmluZGV4KCIwMCIpDQogICAgICAuYnVpbGQoKQ0KICAgIERCQ29udGFpbmVyIGNvbnRhaW5lciA9IHF1ZXJ5LmdldENvbnRhaW5lcigpDQogICAgY29udGFpbmVyLnNldCgiQ1RDT05PIiwgY29ubykNCiAgICBjb250YWluZXIuc2V0KCJDVERJVkkiLCAiIikNCiAgICBjb250YWluZXIuc2V0KCJDVFNUQ08iLCBzdGNvKQ0KICAgIGNvbnRhaW5lci5zZXQoIkNUU1RLWSIsIHN0a3kpDQogICAgY29udGFpbmVyLnNldCgiQ1RMTkNEIiwgbG5jZCkNCiAgICANCiAgICByZXR1cm4gcXVlcnkucmVhZChjb250YWluZXIpDQogIH0NCiAgDQogIC8qKg0KICAqIE1vZGlmaWNhdGlvbiBkZSBsJ2FkcmVzc2UsIHNpIG9uIG5lIGxhIHRyb3V2ZSBwYXMgb24gbGEgY3LDqWUuDQogICovDQogIHByaXZhdGUgdm9pZCB1cGRhdGVBZGRyZXNzKFN0cmluZyBvcm5vLCBTdHJpbmcgYWRydCkgew0KICAgIERCQWN0aW9uIHF1ZXJ5ID0gZGF0YWJhc2UudGFibGUoIk9PQURSRSIpDQogICAgICAuaW5kZXgoIjAwIikNCiAgICAgIC5idWlsZCgpDQogICAgREJDb250YWluZXIgY29udGFpbmVyID0gcXVlcnkuZ2V0Q29udGFpbmVyKCkNCiAgICBjb250YWluZXIuc2V0KCJPRENPTk8iLCBjb25vKQ0KICAgIGNvbnRhaW5lci5zZXQoIk9ET1JOTyIsIG9ybm8pDQogICAgY29udGFpbmVyLnNldCgiT0RBRFJUIiwgdXRpbGl0eS5jYWxsKCJOdW1iZXJVdGlsIiwicGFyc2VTdHJpbmdUb0ludGVnZXIiLCBhZHJ0KSkNCiAgICBjb250YWluZXIuc2V0KCJPREFESUQiLCBtYXAuZ2V0KCJhZGlkIikpDQogICAgDQogICAgQ2xvc3VyZTw/PiB1cGRhdGVDYWxsQmFjayA9IHsgTG9ja2VkUmVzdWx0IGxvY2tlZFJlc3VsdCAtPg0KICAgICAgaWYgKCFtYXAuZ2V0KCJjdW5tIikuaXNFbXB0eSgpKSB7DQogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIk9EQ1VOTSIsIG1hcC5nZXQoImN1bm0iKSkNCiAgICAgIH0NCiAgICAgIGlmICghbWFwLmdldCgiY3VhMSIpLmlzRW1wdHkoKSkgew0KICAgICAgICBsb2NrZWRSZXN1bHQuc2V0KCJPRENVQTEiLCBtYXAuZ2V0KCJjdWExIikpDQogICAgICB9DQogICAgICBpZiAoIW1hcC5nZXQoImN1YTIiKS5pc0VtcHR5KCkpIHsNCiAgICAgICAgbG9ja2VkUmVzdWx0LnNldCgiT0RDVUEyIiwgbWFwLmdldCgiY3VhMiIpKQ0KICAgICAgfQ0KICAgICAgaWYgKCFtYXAuZ2V0KCJjdWEzIikuaXNFbXB0eSgpKSB7DQogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIk9EQ1VBMyIsIG1hcC5nZXQoImN1YTMiKSkNCiAgICAgIH0NCiAgICAgIGlmICghbWFwLmdldCgiY3VhNCIpLmlzRW1wdHkoKSkgew0KICAgICAgICBsb2NrZWRSZXN1bHQuc2V0KCJPRENVQTQiLCBtYXAuZ2V0KCJjdWE0IikpDQogICAgICB9DQogICAgICBpZiAoIW1hcC5nZXQoInBvbm8iKS5pc0VtcHR5KCkpIHsNCiAgICAgICAgbG9ja2VkUmVzdWx0LnNldCgiT0RQT05PIiwgbWFwLmdldCgicG9ubyIpKQ0KICAgICAgfQ0KICAgICAgaWYgKCFtYXAuZ2V0KCJ0b3duIikuaXNFbXB0eSgpKSB7DQogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIk9EVE9XTiIsIG1hcC5nZXQoInRvd24iKSkNCiAgICAgIH0NCiAgICAgIGlmICghbWFwLmdldCgiZWNhciIpLmlzRW1wdHkoKSkgew0KICAgICAgICBsb2NrZWRSZXN1bHQuc2V0KCJPREVDQVIiLCBtYXAuZ2V0KCJlY2FyIikpDQogICAgICB9DQogICAgICBpZiAoIW1hcC5nZXQoImNzY2QiKS5pc0VtcHR5KCkpIHsNCiAgICAgICAgbG9ja2VkUmVzdWx0LnNldCgiT0RDU0NEIiwgbWFwLmdldCgiY3NjZCIpKQ0KICAgICAgfQ0KICAgICAgaWYgKCFtYXAuZ2V0KCJwaG5vIikuaXNFbXB0eSgpKSB7DQogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIk9EUEhOTyIsIG1hcC5nZXQoInBobm8iKSkNCiAgICAgIH0NCiAgICAgIGlmICghbWFwLmdldCgidGZubyIpLmlzRW1wdHkoKSkgew0KICAgICAgICBsb2NrZWRSZXN1bHQuc2V0KCJPRFRGTk8iLCBtYXAuZ2V0KCJ0Zm5vIikpDQogICAgICB9DQogICAgICBpZiAoIW1hcC5nZXQoInlyZWYiKS5pc0VtcHR5KCkpIHsNCiAgICAgICAgbG9ja2VkUmVzdWx0LnNldCgiT0RZUkVGIiwgbWFwLmdldCgieXJlZiIpKQ0KICAgICAgfQ0KICAgICAgaWYgKCFtYXAuZ2V0KCJ2cm5vIikuaXNFbXB0eSgpKSB7DQogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIk9EVlJOTyIsIG1hcC5nZXQoInZybm8iKSkNCiAgICAgIH0NCiAgICAgIGlmICghbWFwLmdldCgic3BsZSIpLmlzRW1wdHkoKSkgew0KICAgICAgICBsb2NrZWRSZXN1bHQuc2V0KCJPRFNQTEUiLCBtYXAuZ2V0KCJzcGxlIikpDQogICAgICB9DQogICAgICBpZiAoIW1hcC5nZXQoImNzY2QiKS5pc0VtcHR5KCkpIHsNCiAgICAgICAgbG9ja2VkUmVzdWx0LnNldCgiT0RDU0NEIiwgbWFwLmdldCgiY3NjZCIpKQ0KICAgICAgfQ0KICAgICAgaWYgKCFtYXAuZ2V0KCJoYWZlIikuaXNFbXB0eSgpKSB7DQogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIk9ESEFGRSIsIG1hcC5nZXQoImhhZmUiKSkNCiAgICAgIH0NCiAgICAgIGlmICghbWFwLmdldCgicmFzbiIpLmlzRW1wdHkoKSkgew0KICAgICAgICBsb2NrZWRSZXN1bHQuc2V0KCJPRFJBU04iLCBtYXAuZ2V0KCJyYXNuIikpDQogICAgICB9ICAgICAgDQogICAgICBpZiAoIW1hcC5nZXQoImVkZXMiKS5pc0VtcHR5KCkpIHsNCiAgICAgICAgbG9ja2VkUmVzdWx0LnNldCgiT0RFREVTIiwgbWFwLmdldCgiZWRlcyIpKQ0KICAgICAgfQ0KICAgICAgaWYgKCFtYXAuZ2V0KCJkbHNwIikuaXNFbXB0eSgpKSB7DQogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIk9ERExTUCIsIG1hcC5nZXQoImRsc3AiKSkNCiAgICAgIH0gICAgIA0KICAgICAgaWYgKCFtYXAuZ2V0KCJkc3R4IikuaXNFbXB0eSgpKSB7DQogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIk9ERFNUWCIsIG1hcC5nZXQoImRzdHgiKSkNCiAgICAgIH0NCiAgICAgIGlmICghbWFwLmdldCgibW9kbCIpLmlzRW1wdHkoKSkgew0KICAgICAgICBsb2NrZWRSZXN1bHQuc2V0KCJPRE1PREwiLCBtYXAuZ2V0KCJtb2RsIikpDQogICAgICB9DQogICAgICBpZiAoIW1hcC5nZXQoInRlZGwiKS5pc0VtcHR5KCkpIHsNCiAgICAgICAgbG9ja2VkUmVzdWx0LnNldCgiT0RURURMIiwgbWFwLmdldCgidGVkbCIpKQ0KICAgICAgfQ0KICAgICAgaWYgKCFtYXAuZ2V0KCJ0ZWwyIikuaXNFbXB0eSgpKSB7DQogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIk9EVEVMMiIsIG1hcC5nZXQoInRlbDIiKSkNCiAgICAgIH0NCiAgICAgIGludCBjaG5vID0gbG9ja2VkUmVzdWx0LmdldCgiT0RDSE5PIikNCiAgICAgIGNobm8rKw0KICAgICAgbG9ja2VkUmVzdWx0LnNldCgiT0RMTURUIiwgdXRpbGl0eS5jYWxsKCJEYXRlVXRpbCIsImN1cnJlbnREYXRlWThBc0ludCIpKQ0KICAgICAgbG9ja2VkUmVzdWx0LnNldCgiT0RDSE5PIiwgY2hubykNCiAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIk9EQ0hJRCIsIGNoaWQpDQogICAgICANCiAgICAgIGxvY2tlZFJlc3VsdC51cGRhdGUoKQ0KICAgIH0NCiAgICANCiAgICBpZiAoIXF1ZXJ5LnJlYWRMb2NrKGNvbnRhaW5lciwgdXBkYXRlQ2FsbEJhY2spKSB7DQogICAgICBjcmVhdGVBZGRyZXNzKG9ybm8sIGFkcnQpDQogICAgfQ0KICAgIA0KICAgIGlmIChhZHJ0LmVxdWFscygiMSIpKSB7DQogICAgICB1cGRhdEFkaWRJbk9PSEVBRCgpDQogICAgfQ0KICB9DQogIA0KICAvKioNCiAgKiBDcsOpYXRpb24gZGUgbCdhZHJlc3NlIGRhbnMgT09BRFJFLg0KICAqLw0KICBwcml2YXRlIHZvaWQgY3JlYXRlQWRkcmVzcyhTdHJpbmcgb3JubywgU3RyaW5nIGFkcnQpIHsNCiAgICAgREJBY3Rpb24gcXVlcnkgPSBkYXRhYmFzZS50YWJsZSgiT09BRFJFIikNCiAgICAgIC5pbmRleCgiMDAiKQ0KICAgICAgLmJ1aWxkKCkNCiAgICBEQkNvbnRhaW5lciBjb250YWluZXIgPSBxdWVyeS5nZXRDb250YWluZXIoKQ0KICAgIGNvbnRhaW5lci5zZXQoIk9EQ09OTyIsIGNvbm8pDQogICAgY29udGFpbmVyLnNldCgiT0RPUk5PIiwgb3JubykNCiAgICBjb250YWluZXIuc2V0KCJPREFEUlQiLCB1dGlsaXR5LmNhbGwoIk51bWJlclV0aWwiLCJwYXJzZVN0cmluZ1RvSW50ZWdlciIsIGFkcnQpKQ0KICAgIGNvbnRhaW5lci5zZXQoIk9EQURJRCIsIG1hcC5nZXQoImFkaWQiKSkNCiAgICANCiAgICBPcHRpb25hbDxEQkNvbnRhaW5lcj4gY3VzdG9tZXJDb250YWluZXIgPSBzZWFyY2hDdXN0b21lckFkZHJlc3MoYWRydCkNCiAgICBib29sZWFuIGNpZG1hc0V4aXN0ID0gZmFsc2UNCiAgICBEQkNvbnRhaW5lciByZWNvcmQgPSBudWxsDQogICAgaWYgKGN1c3RvbWVyQ29udGFpbmVyLmlzUHJlc2VudCgpKSB7DQogICAgICBjaWRtYXNFeGlzdCA9IHRydWUNCiAgICAgIHJlY29yZCA9IGN1c3RvbWVyQ29udGFpbmVyLmdldCgpDQogICAgfQ0KICAgIA0KICAgIGlmICghbWFwLmdldCgiY3VubSIpLmlzRW1wdHkoKSkgew0KICAgICAgY29udGFpbmVyLnNldCgiT0RDVU5NIiwgbWFwLmdldCgiY3VubSIpKQ0KICAgIH0gZWxzZSBpZiAoY2lkbWFzRXhpc3QpIHsNCiAgICAgIGNvbnRhaW5lci5zZXQoIk9EQ1VOTSIsIFN0cmluZy52YWx1ZU9mKHJlY29yZC5nZXQoIk9QQ1VOTSIpKSkNCiAgICB9DQogICAgaWYgKCFtYXAuZ2V0KCJjdWExIikuaXNFbXB0eSgpKSB7DQogICAgICBjb250YWluZXIuc2V0KCJPRENVQTEiLCBtYXAuZ2V0KCJjdWExIikpDQogICAgfSBlbHNlIGlmIChjaWRtYXNFeGlzdCkgew0KICAgICAgY29udGFpbmVyLnNldCgiT0RDVUExIiwgU3RyaW5nLnZhbHVlT2YocmVjb3JkLmdldCgiT1BDVUExIikpKQ0KICAgIH0NCiAgICBpZiAoIW1hcC5nZXQoImN1YTIiKS5pc0VtcHR5KCkpIHsNCiAgICAgIGNvbnRhaW5lci5zZXQoIk9EQ1VBMiIsIG1hcC5nZXQoImN1YTIiKSkNCiAgICB9IGVsc2UgaWYgKGNpZG1hc0V4aXN0KSB7DQogICAgICBjb250YWluZXIuc2V0KCJPRENVQTIiLCBTdHJpbmcudmFsdWVPZihyZWNvcmQuZ2V0KCJPUENVQTIiKSkpDQogICAgfQ0KICAgIGlmICghbWFwLmdldCgiY3VhMyIpLmlzRW1wdHkoKSkgew0KICAgICAgY29udGFpbmVyLnNldCgiT0RDVUEzIiwgbWFwLmdldCgiY3VhMyIpKQ0KICAgIH0gZWxzZSBpZiAoY2lkbWFzRXhpc3QpIHsNCiAgICAgIGNvbnRhaW5lci5zZXQoIk9EQ1VBMyIsIFN0cmluZy52YWx1ZU9mKHJlY29yZC5nZXQoIk9QQ1VBMyIpKSkNCiAgICB9DQogICAgaWYgKCFtYXAuZ2V0KCJjdWE0IikuaXNFbXB0eSgpKSB7DQogICAgICBjb250YWluZXIuc2V0KCJPRENVQTQiLCBtYXAuZ2V0KCJjdWE0IikpDQogICAgfSBlbHNlIGlmIChjaWRtYXNFeGlzdCkgew0KICAgICAgY29udGFpbmVyLnNldCgiT0RDVUE0IiwgU3RyaW5nLnZhbHVlT2YocmVjb3JkLmdldCgiT1BDVUE0IikpKQ0KICAgIH0NCiAgICBpZiAoIW1hcC5nZXQoInBvbm8iKS5pc0VtcHR5KCkpIHsNCiAgICAgIGNvbnRhaW5lci5zZXQoIk9EUE9OTyIsIG1hcC5nZXQoInBvbm8iKSkNCiAgICB9IGVsc2UgaWYgKGNpZG1hc0V4aXN0KSB7DQogICAgICBjb250YWluZXIuc2V0KCJPRFBPTk8iLCBTdHJpbmcudmFsdWVPZihyZWNvcmQuZ2V0KCJPUFBPTk8iKSkpDQogICAgfQ0KICAgIGlmICghbWFwLmdldCgidG93biIpLmlzRW1wdHkoKSkgew0KICAgICAgY29udGFpbmVyLnNldCgiT0RUT1dOIiwgbWFwLmdldCgidG93biIpKQ0KICAgIH0gZWxzZSBpZiAoY2lkbWFzRXhpc3QpIHsNCiAgICAgIGNvbnRhaW5lci5zZXQoIk9EVE9XTiIsIFN0cmluZy52YWx1ZU9mKHJlY29yZC5nZXQoIk9QVE9XTiIpKSkNCiAgICB9DQogICAgaWYgKCFtYXAuZ2V0KCJlY2FyIikuaXNFbXB0eSgpKSB7DQogICAgICBjb250YWluZXIuc2V0KCJFQ0FSIiwgbWFwLmdldCgiZWNhciIpKQ0KICAgIH0gZWxzZSBpZiAoY2lkbWFzRXhpc3QpIHsNCiAgICAgIGNvbnRhaW5lci5zZXQoIk9ERUNBUiIsIFN0cmluZy52YWx1ZU9mKHJlY29yZC5nZXQoIk9QRUNBUiIpKSkNCiAgICB9DQogICAgaWYgKCFtYXAuZ2V0KCJjc2NkIikuaXNFbXB0eSgpKSB7DQogICAgICBjb250YWluZXIuc2V0KCJPRENTQ0QiLCBtYXAuZ2V0KCJjc2NkIikpDQogICAgfSBlbHNlIGlmIChjaWRtYXNFeGlzdCkgew0KICAgICAgY29udGFpbmVyLnNldCgiT0RDU0NEIiwgU3RyaW5nLnZhbHVlT2YocmVjb3JkLmdldCgiT1BDU0NEIikpKQ0KICAgIH0NCiAgICBpZiAoIW1hcC5nZXQoInBobm8iKS5pc0VtcHR5KCkpIHsNCiAgICAgIGNvbnRhaW5lci5zZXQoIk9EUEhOTyIsIG1hcC5nZXQoInBobm8iKSkNCiAgICB9IGVsc2UgaWYgKGNpZG1hc0V4aXN0KSB7DQogICAgICBjb250YWluZXIuc2V0KCJPRFBITk8iLCBTdHJpbmcudmFsdWVPZihyZWNvcmQuZ2V0KCJPUFBITk8iKSkpDQogICAgfQ0KICAgIGlmICghbWFwLmdldCgidGZubyIpLmlzRW1wdHkoKSkgew0KICAgICAgY29udGFpbmVyLnNldCgiT0RURk5PIiwgbWFwLmdldCgidGZubyIpKQ0KICAgIH0gZWxzZSBpZiAoY2lkbWFzRXhpc3QpIHsNCiAgICAgIGNvbnRhaW5lci5zZXQoIk9EVEZOTyIsIFN0cmluZy52YWx1ZU9mKHJlY29yZC5nZXQoIk9QVEZOTyIpKSkNCiAgICB9DQogICAgaWYgKCFtYXAuZ2V0KCJ5cmVmIikuaXNFbXB0eSgpKSB7DQogICAgICBjb250YWluZXIuc2V0KCJPRFlSRUYiLCBtYXAuZ2V0KCJ5cmVmIikpDQogICAgfSBlbHNlIGlmIChjaWRtYXNFeGlzdCkgew0KICAgICAgY29udGFpbmVyLnNldCgiT0RZUkVGIiwgU3RyaW5nLnZhbHVlT2YocmVjb3JkLmdldCgiT1BZUkVGIikpKQ0KICAgIH0NCiAgICBpZiAoIW1hcC5nZXQoInZybm8iKS5pc0VtcHR5KCkpIHsNCiAgICAgIGNvbnRhaW5lci5zZXQoIk9EVlJOTyIsIG1hcC5nZXQoInZybm8iKSkNCiAgICB9IGVsc2UgaWYgKGNpZG1hc0V4aXN0KSB7DQogICAgICBjb250YWluZXIuc2V0KCJPRFZSTk8iLCBTdHJpbmcudmFsdWVPZihyZWNvcmQuZ2V0KCJPUFZSTk8iKSkpDQogICAgfQ0KICAgIGlmICghbWFwLmdldCgic3BsZSIpLmlzRW1wdHkoKSkgew0KICAgICAgY29udGFpbmVyLnNldCgiT0RTUExFIiwgbWFwLmdldCgic3BsZSIpKQ0KICAgIH0gZWxzZSBpZiAoY2lkbWFzRXhpc3QpIHsNCiAgICAgIGNvbnRhaW5lci5zZXQoIk9EU1BMRSIsIFN0cmluZy52YWx1ZU9mKHJlY29yZC5nZXQoIk9QU1BMRSIpKSkNCiAgICB9DQogICAgaWYgKCFtYXAuZ2V0KCJoYWZlIikuaXNFbXB0eSgpKSB7DQogICAgICBjb250YWluZXIuc2V0KCJPREhBRkUiLCBtYXAuZ2V0KCJoYWZlIikpDQogICAgfSBlbHNlIGlmIChjaWRtYXNFeGlzdCkgew0KICAgICAgY29udGFpbmVyLnNldCgiT0RIQUZFIiwgU3RyaW5nLnZhbHVlT2YocmVjb3JkLmdldCgiT1BIQUZFIikpKQ0KICAgIH0NCiAgICBpZiAoIW1hcC5nZXQoInJhc24iKS5pc0VtcHR5KCkpIHsNCiAgICAgIGNvbnRhaW5lci5zZXQoIk9EUkFTTiIsIG1hcC5nZXQoImhhZmUiKSkNCiAgICB9IGVsc2UgaWYgKGNpZG1hc0V4aXN0KSB7DQogICAgICBjb250YWluZXIuc2V0KCJPRFJBU04iLCBTdHJpbmcudmFsdWVPZihyZWNvcmQuZ2V0KCJPUFJBU04iKSkpDQogICAgfSAgICANCiAgICBpZiAoIW1hcC5nZXQoImVkZXMiKS5pc0VtcHR5KCkpIHsNCiAgICAgIGNvbnRhaW5lci5zZXQoIk9ERURFUyIsIG1hcC5nZXQoImVkZXMiKSkNCiAgICB9IGVsc2UgaWYgKGNpZG1hc0V4aXN0KSB7DQogICAgICBjb250YWluZXIuc2V0KCJPREVERVMiLCBTdHJpbmcudmFsdWVPZihyZWNvcmQuZ2V0KCJPUEVERVMiKSkpDQogICAgfSAgICANCiAgICBpZiAoIW1hcC5nZXQoImRsc3AiKS5pc0VtcHR5KCkpIHsNCiAgICAgIGNvbnRhaW5lci5zZXQoIk9ERExTUCIsIG1hcC5nZXQoImRsc3AiKSkNCiAgICB9ICANCiAgICBpZiAoIW1hcC5nZXQoImRzdHgiKS5pc0VtcHR5KCkpIHsNCiAgICAgIGNvbnRhaW5lci5zZXQoIk9ERFNUWCIsIG1hcC5nZXQoImRzdHgiKSkNCiAgICB9ICAgDQogICAgaWYgKCFtYXAuZ2V0KCJtb2RsIikuaXNFbXB0eSgpKSB7DQogICAgICBjb250YWluZXIuc2V0KCJPRE1PREwiLCBtYXAuZ2V0KCJtb2RsIikpDQogICAgfSBlbHNlIGlmIChjaWRtYXNFeGlzdCkgew0KICAgICAgY29udGFpbmVyLnNldCgiT0RNT0RMIiwgU3RyaW5nLnZhbHVlT2YocmVjb3JkLmdldCgiT1BNT0RMIikpKQ0KICAgIH0gICAgDQogICAgaWYgKCFtYXAuZ2V0KCJ0ZWRsIikuaXNFbXB0eSgpKSB7DQogICAgICBjb250YWluZXIuc2V0KCJPRFRFREwiLCBtYXAuZ2V0KCJ0ZWwiKSkNCiAgICB9IGVsc2UgaWYgKGNpZG1hc0V4aXN0KSB7DQogICAgICBjb250YWluZXIuc2V0KCJPRFRFREwiLCBTdHJpbmcudmFsdWVPZihyZWNvcmQuZ2V0KCJPUFRFREwiKSkpDQogICAgfSANCiAgICBpZiAoIW1hcC5nZXQoInRlbDIiKS5pc0VtcHR5KCkpIHsNCiAgICAgIGNvbnRhaW5lci5zZXQoIk9EVEVMMiIsIG1hcC5nZXQoInRlbDIiKSkNCiAgICB9IGVsc2UgaWYgKGNpZG1hc0V4aXN0KSB7DQogICAgICBjb250YWluZXIuc2V0KCJPRFRFTDIiLCBTdHJpbmcudmFsdWVPZihyZWNvcmQuZ2V0KCJPUFRFTDIiKSkpDQogICAgfSAgDQogICAgDQogICAgY29udGFpbmVyLnNldCgiT0RSR0RUIiwgdXRpbGl0eS5jYWxsKCJEYXRlVXRpbCIsImN1cnJlbnREYXRlWThBc0ludCIpKQ0KICAgIGNvbnRhaW5lci5zZXQoIk9EUkdUTSIsIHV0aWxpdHkuY2FsbCgiRGF0ZVV0aWwiLCJjdXJyZW50VGltZUFzSW50IikpDQogICAgY29udGFpbmVyLnNldCgiT0RMTURUIiwgdXRpbGl0eS5jYWxsKCJEYXRlVXRpbCIsImN1cnJlbnREYXRlWThBc0ludCIpKQ0KICAgIGNvbnRhaW5lci5zZXQoIk9EQ0hOTyIsIDEpDQogICAgY29udGFpbmVyLnNldCgiT0RDSElEIiwgY2hpZCkNCiAgICANCiAgICBxdWVyeS5pbnNlcnQoY29udGFpbmVyKQ0KICB9DQogIA0KICAvKioNCiAgKiBSZWNoZXJjaGUgZGUgbCdhZHJlc3NlIGNsaWVudCBwb3VyIHLDqWN1cMOpcmVyIGxlcyBkb25uw6llcyBkZSBsYWRyZXNzZSBjbGllbnQgbG9ycyBkJ3VuZSBjcsOpYXRpb24gZGFucyBPT0FEUkUuDQogICovDQogIHByaXZhdGUgT3B0aW9uYWw8REJDb250YWluZXI+IHNlYXJjaEN1c3RvbWVyQWRkcmVzcyhTdHJpbmcgYWRydCkgew0KICAgIERCQWN0aW9uIHF1ZXJ5ID0gZGF0YWJhc2UudGFibGUoIk9DVVNBRCIpDQogICAgLmluZGV4KCIwMCIpDQogICAgLnNlbGVjdGlvbigiT1BDVU5NIiwgIk9QQ1VBMSIsICJPUENVQTIiLCAiT1BDVUEzIiwgIk9QQ1VBNCIsICJPUFBPTk8iLCAiT1BUT1dOIiwgIk9QRUNBUiIsICJPUENTQ0QiLCAiT1BQSE5PIiwgIk9QVEZOTyIsICJPUFlSRUYiLCAiT1BWUk5PIiwgIk9QU1BMRSIsICJPUEhBRkUiLA0KICAgICAgICAgICAgICAgICJPUFJBU04iLCAiT1BFREVTIiwgIk9QTU9ETCIsICJPUFRFREwiLCAiT1BURUwyIikNCiAgICAuYnVpbGQoKQ0KICAgIERCQ29udGFpbmVyIGNvbnRhaW5lciA9IHF1ZXJ5LmdldENvbnRhaW5lcigpDQogICAgDQogICAgY29udGFpbmVyLnNldCgiT1BDT05PIiwgY29ubykNCiAgICBjb250YWluZXIuc2V0KCJPUENVTk8iLCBjdW5vKQ0KICAgIGNvbnRhaW5lci5zZXQoIk9QQURSVCIsIHV0aWxpdHkuY2FsbCgiTnVtYmVyVXRpbCIsInBhcnNlU3RyaW5nVG9JbnRlZ2VyIiwgYWRydCkpDQogICAgY29udGFpbmVyLnNldCgiT1BBRElEIiwgbWFwLmdldCgiYWRpZCIpKQ0KICAgIA0KICAgIGJvb2xlYW4gZm91bmQgPSBxdWVyeS5yZWFkKGNvbnRhaW5lcikNCiAgICANCiAgICBpZiAoZm91bmQpIHsNCiAgICAgIHJldHVybiBPcHRpb25hbC5vZihjb250YWluZXIpDQogICAgfSBlbHNlIHsNCiAgICAgIHJldHVybiBPcHRpb25hbC5lbXB0eSgpDQogICAgfQ0KICB9DQogIA0KICAvKioNCiAgKiBNaXNlIMOgIGpvdXIgZGUgbCdBRElEIGRhbnMgT09IRUFEIHMnaWwgZXN0IGRpZmbDqXJlbnQgZGUgY2VsdWkgcmVudHLDqSBlbiBlbnRyw6llIGRlIGwnQVBJLg0KICAqLw0KICBwcml2YXRlIHZvaWQgdXBkYXRBZGlkSW5PT0hFQUQoKSB7DQogICAgaWYgKGFkaWRPT0hFQUQuaXNFbXB0eSgpIHx8ICFhZGlkT09IRUFELmVxdWFscyhtYXAuZ2V0KCJhZGlkIikpKSB7DQogICAgICBhZGlkT09IRUFEID0gbWFwLmdldCgiYWRpZCIpDQogICAgICANCiAgICAgIERCQWN0aW9uIHF1ZXJ5ID0gZGF0YWJhc2UudGFibGUoIk9PSEVBRCIpDQogICAgICAgIC5pbmRleCgiMDAiKQ0KICAgICAgICAuYnVpbGQoKQ0KICAgICAgREJDb250YWluZXIgY29udGFpbmVyID0gcXVlcnkuZ2V0Q29udGFpbmVyKCkNCiAgICAgIGNvbnRhaW5lci5zZXQoIk9BQ09OTyIsIGNvbm8pDQogICAgICBjb250YWluZXIuc2V0KCJPQU9STk8iLCBvcm5vKQ0KICAgICAgDQogICAgICBDbG9zdXJlPD8+IHVwZGF0ZUNhbGxCYWNrID0geyBMb2NrZWRSZXN1bHQgbG9ja2VkUmVzdWx0IC0+DQogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIk9BQURJRCIsIGFkaWRPT0hFQUQpDQogICAgICAgIGludCBjaG5vID0gbG9ja2VkUmVzdWx0LmdldCgiT0FDSE5PIikNCiAgICAgICAgY2hubysrDQogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIk9BTE1EVCIsIHV0aWxpdHkuY2FsbCgiRGF0ZVV0aWwiLCJjdXJyZW50RGF0ZVk4QXNJbnQiKSkNCiAgICAgICAgbG9ja2VkUmVzdWx0LnNldCgiT0FDSE5PIiwgY2hubykNCiAgICAgICAgbG9ja2VkUmVzdWx0LnNldCgiT0FDSElEIiwgY2hpZCkNCiAgDQogICAgICAgIGxvY2tlZFJlc3VsdC51cGRhdGUoKQ0KICAgICAgfQ0KICAgICAgDQogICAgICBxdWVyeS5yZWFkTG9jayhjb250YWluZXIsIHVwZGF0ZUNhbGxCYWNrKQ0KICAgIH0NCiAgfQ0KDQp9"}}}